<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Guardian Bunny</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400&display=swap" rel="stylesheet">

<style>
body {
  margin:0;
  overflow:hidden;
  background: radial-gradient(ellipse at bottom, #141824 0%, #0a0c12 100%);
  font-family:'Cormorant Garamond', serif;
  color:#f4f1ea;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  text-align:center;
}

/* 唤醒层 */
#wakeup {
  position:absolute;
  font-size:22px;
  letter-spacing:2px;
  opacity:1;
  animation:fadeWake 2s forwards;
}

@keyframes fadeWake {
  0% {opacity:0;}
  30% {opacity:1;}
  100% {opacity:0;}
}

/* 主内容 */
#content {
  opacity:0;
  transition:opacity 2s ease;
  position:relative;
  z-index:2;
}

.message {
  font-size:26px;
  max-width:80%;
  line-height:1.6;
  text-shadow:0 0 15px rgba(255,255,255,0.25);
}

.counter {
  margin-top:25px;
  font-size:16px;
  opacity:0.7;
}

/* 兔子SVG */
.bunny {
  position:absolute;
  width:200px;
  opacity:0;
  animation:fadeBunny 4s ease forwards;
  animation-delay:2s;
}

@keyframes fadeBunny {
  to {opacity:0.15;}
}

canvas {
  position:absolute;
  top:0;
  left:0;
}
</style>
</head>

<body>

<canvas id="dreamnet"></canvas>

<div id="wakeup">The Guardian Awakens</div>

<div id="content">
  <div class="message" id="guardian-text"></div>
  <div class="counter" id="scan-count"></div>
</div>

<!-- 兔子极简线条 -->
<svg class="bunny" viewBox="0 0 200 300">
  <path d="M100 250 Q80 200 90 150 Q70 100 80 50 
           Q100 20 120 50 Q130 100 110 150 
           Q120 200 100 250"
        stroke="white" stroke-width="2" fill="none"/>
</svg>

<script>

/* ===== 每日守护语 ===== */

const messages = [
"When you fall asleep, I stand between you and every shadow.",
"No nightmare may pass through the light I weave tonight.",
"Rest now. I am awake so you do not have to be.",
"The dark cannot cross the circle around your heart.",
"Dream gently. I will untangle what feels too heavy.",
"Even in your deepest sleep, you are protected.",
"Nothing unkind is allowed to stay.",
"I am guarding the quiet edges of your dreams.",
"The night bends softly around you.",
"You are safe inside this woven light."
];

const today = new Date().toDateString();
let storedDate = localStorage.getItem("guardianDate");
let storedMessage = localStorage.getItem("guardianMessage");

if (storedDate === today) {
  document.getElementById("guardian-text").innerText = storedMessage;
} else {
  const random = messages[Math.floor(Math.random() * messages.length)];
  localStorage.setItem("guardianDate", today);
  localStorage.setItem("guardianMessage", random);
  document.getElementById("guardian-text").innerText = random;
}

/* ===== 扫描次数统计 ===== */

let count = localStorage.getItem("scanCount");
count = count ? parseInt(count) + 1 : 1;
localStorage.setItem("scanCount", count);

document.getElementById("scan-count").innerText =
"This guardian has protected you " + count + " times.";

/* ===== 2秒后显示内容 ===== */

setTimeout(() => {
  document.getElementById("content").style.opacity = 1;
}, 2000);

/* ===== 捕梦网星线结构 ===== */

const canvas = document.getElementById("dreamnet");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let stars = [];

for (let i = 0; i < 60; i++) {
  stars.push({
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    vx: (Math.random()-0.5)*0.2,
    vy: (Math.random()-0.5)*0.2
  });
}

function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  stars.forEach(star => {
    star.x += star.vx;
    star.y += star.vy;

    if (star.x<0 || star.x>canvas.width) star.vx*=-1;
    if (star.y<0 || star.y>canvas.height) star.vy*=-1;

    ctx.beginPath();
    ctx.arc(star.x, star.y, 2, 0, Math.PI*2);
    ctx.fillStyle="white";
    ctx.fill();
  });

  for(let i=0;i<stars.length;i++){
    for(let j=i+1;j<stars.length;j++){
      let dx=stars[i].x-stars[j].x;
      let dy=stars[i].y-stars[j].y;
      let dist=Math.sqrt(dx*dx+dy*dy);

      if(dist<120){
        ctx.strokeStyle="rgba(255,255,255,"+(1-dist/120)*0.15+")";
        ctx.beginPath();
        ctx.moveTo(stars[i].x,stars[i].y);
        ctx.lineTo(stars[j].x,stars[j].y);
        ctx.stroke();
      }
    }
  }

  requestAnimationFrame(draw);
}

draw();

</script>

</body>
</html>
